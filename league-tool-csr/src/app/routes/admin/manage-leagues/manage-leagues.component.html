<!-- manage-leagues.component.html -->
<div class="manage-leagues-container">
    <mat-card class="create-game-section">
      <mat-card-header>
        <mat-card-title>Create New Game</mat-card-title>
      </mat-card-header>
      
      <mat-card-content>
        <form [formGroup]="gameForm" (ngSubmit)="createGame()">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Game Name</mat-label>
            <input matInput formControlName="name" placeholder="Enter game name">
            @if (gameForm.get('name')?.hasError('required')) {
              <mat-error>Name is required</mat-error>
            }
            @if (gameForm.get('name')?.hasError('minlength')) {
              <mat-error>Name must be at least 3 characters</mat-error>
            }
          </mat-form-field>
     
          
          <mat-slide-toggle formControlName="active" color="primary">
            Active
          </mat-slide-toggle>
  
          <button mat-raised-button color="primary" type="submit" 
                  [disabled]="!gameForm.valid || isLoading">
            <mat-icon>add</mat-icon>
            Create Game
          </button>
        </form>
      </mat-card-content>
    </mat-card>
  
    <div class="games-section">
      <mat-card class="games-list">
        <mat-card-header>
          <mat-card-title>Games</mat-card-title>
        </mat-card-header>
        
        <mat-card-content>
          @if (isLoading) {
            <mat-progress-bar mode="indeterminate"></mat-progress-bar>
          }
          
          <mat-nav-list>
            @for (game of games; track game._id) {
              <mat-list-item (click)="selectGame(game)"
                            [class.selected]="selectedGame?._id === game._id">
                <mat-icon matListItemIcon>sports_esports</mat-icon>
                <span matListItemTitle>{{game.name}}</span>
                <mat-chip-list matListItemMeta>
                  <mat-chip [color]="game.active ? 'accent' : 'warn'" selected>
                    {{game.active ? 'Active' : 'Inactive'}}
                  </mat-chip>
                </mat-chip-list>
              </mat-list-item>
            } @empty {
              <mat-list-item>
                <span matListItemTitle>No games available</span>
              </mat-list-item>
            }
          </mat-nav-list>
        </mat-card-content>
      </mat-card>
  
      @if (selectedGame) {
        <mat-card class="add-league-section">
          <mat-card-header>
            <mat-card-title>Add League to {{selectedGame.name}}</mat-card-title>
          </mat-card-header>
          
          <mat-card-content>
            <form [formGroup]="leagueForm" (ngSubmit)="addLeague()">
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>League Name</mat-label>
                <input matInput formControlName="name" placeholder="Enter league name">
                @if (leagueForm.get('name')?.hasError('required')) {
                  <mat-error>Name is required</mat-error>
                }
                @if (leagueForm.get('name')?.hasError('minlength')) {
                  <mat-error>Name must be at least 3 characters</mat-error>
                }
              </mat-form-field>
              <mat-form-field></mat-form-field>
              
              <mat-slide-toggle formControlName="active" color="primary">
                Active
              </mat-slide-toggle>
  
              <button mat-raised-button color="accent" type="submit"
                      [disabled]="!leagueForm.valid || isLoading">
                <mat-icon>add_circle</mat-icon>
                Add League
              </button>
            </form>
  
            <mat-divider class="margin-y"></mat-divider>
  
            <h3>Existing Leagues</h3>
            <mat-list>
              @for (league of selectedGame.leagues; track league.name) {
                <mat-list-item>
                  <mat-icon matListItemIcon>sports</mat-icon>
                  <span matListItemTitle>{{league.name}}</span>
                  <mat-chip-list matListItemMeta>
                    <mat-chip [color]="league.active ? 'accent' : 'warn'" selected>
                      {{league.active ? 'Active' : 'Inactive'}}
                    </mat-chip>
                  </mat-chip-list>
                </mat-list-item>
              } @empty {
                <mat-list-item>
                  <span matListItemTitle>No leagues available</span>
                </mat-list-item>
              }
            </mat-list>
          </mat-card-content>
        </mat-card>
      }
    </div>
  </div>